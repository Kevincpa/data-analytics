## 第二章：分析师的必备武器库-EXCEL

### Excel基本数据类型

#### 基本数据类型：

文本型（string）：ABCDE，数据

整数型（int）：10、1、9

小数型（float）：1.1、2.5、9.9

布尔型（bool）：TRUE、FALSE ——值得注意的是，这个和编写程序中的布尔型不一样，这里不代表1和0

日期型（date）：长日期（年月日时分秒）、短日期（年月日）

其他类型：会计、特殊

这些可以归类为文本型，布尔型，和数值型

#### 变量类型：

名义型：彼此间没有顺序关系，指标是分类的数据，比如性别、血型

有序型：有顺序关系的数据，如形容工程机好坏的优良中差。星期一，星期二，这些是有序型

连续型：有顺序，包含若干小数位切缺纸秘籍的数据，如：身高、体重、温度等，而时间则是这个



注意：有时候看起来是数字的类型有可能不是数值型，而是文本型，比方说身份证号码，在前面可能有单引号（‘），这是强行将数值转为文本的

#### Data Types 数据类型

| 1.单元格数据类型： |      |
| ------------------ | ---- |
| A numeric value    | 数值 |
| Text               | 文本 |
| A formula          | 公式 |



| 2.内部对象类型 | （不能包含在单元格中）                                       |
| -------------- | ------------------------------------------------------------ |
| Charts         | 图表                                                         |
| Diagrams       | 形状                                                         |
| Pictures       | 图片                                                         |
| Buttons        | 表单工具（所谓的控件）分为：（1）表单控件（基于工作表） （2）ActiveX控件（基于VBA） |

表单工具中的开发工具，假如没有，可以在选项里面选择

![image-20191124122633195](数据分析师(Excel+SQL).assets/image-20191124122633195.png)



#### Cell Format/单元格格式：

设置格式的方式：

1. 开始菜单栏
2. 快捷Ctrl+1
3. 右键单击菜单，选择设置单元格格式

| 单元格格式          | 快捷键：Ctrl+1                                        |
| ------------------- | ----------------------------------------------------- |
| General/常规        | Excel会自动识别你所输入的数据，并赋予其文本或数据格式 |
| Nunmber/数值        | 设置千分位、小数位数及负数显示方式                    |
| Currency/货币       | 设置货币符号、小数位数及负数显示方式                  |
| Accounting/会计专用 | 同上，但货币符号左对齐                                |
| Date/日期           | 设置不同日期格式                                      |
| Time/时间           | 设置不同时间格式                                      |
| Percentage/百分比   | 设置百分比及小数位                                    |
| Fraction/分数       | 设置九种分数格式                                      |
| Scientific/科学计数 | 设置科学计数法格式                                    |
| Special/特殊        | 设置邮政编码，大小写中文数字                          |
| Customer/自定义     | 设置自己想要的任何格式                                |

通配符及含义：

| 通配符   | 含义                                                         |
| -------- | ------------------------------------------------------------ |
| G/       | 通用格式，是指不设置任何格式，按原始输入的数值显示           |
| #        | 数字占位符，只显示有效数字，不显示无意义的零值               |
| 0        | 数字占位符，当数字比代码的数量少时，显示为无意义的0          |
| ?        | 数字占位符，作用是在小数点两侧增加空格，效果有点像word标尺中的小数点对齐 |
| .        | 小数点                                                       |
| %        | 百分数                                                       |
| ,        | 千分位分隔符                                                 |
| E        | 科学计数符号                                                 |
| \        | 显示格式的下一个字符                                         |
| *        | 重复下一个字符填充列宽                                       |
| _        | 留出与下一个字符等宽的空格                                   |
| "文本"   | 显示文本                                                     |
| @        | 文本占位符，如果只用一个@，作用是引用原始文本，即在单元格中输入的文本用@代替，如果使用多个@，可以重复单元格中输入的文本 |
| [颜色]   | 注意[颜色] 应放在数字占位符的前面设置，中文版中用中文，英文版中用英文 |
| [条件值] | 一般设置顺序是这样的[条件值] [颜色] 数字占位符 [颜色]的位置可以使其他显示格式 |

示例：

|          | 原始数值    | 显示为                 | 格式                                        |
| -------- | ----------- | ---------------------- | ------------------------------------------- |
| #        | 1234.56     | 1234.56                | #.#                                         |
|          | 12          | 12.                    | #.#                                         |
|          | 0           | .                      | #.#                                         |
|          |             |                        |                                             |
| 0        | 5678        | 5678.00                | 0000.00                                     |
|          | 5.678       | 0005.68                | 0000.00                                     |
|          | 56          | 0056.00                | 0000.00                                     |
|          | 0           | 0000.00                | 0000.00                                     |
|          |             |                        |                                             |
| # 加上 0 | 123456      | 123456.0               | #0.0                                        |
|          | 123.546     | 123.5                  | #0.0                                        |
|          | 0           | 0.0                    | #0.0                                        |
|          |             |                        |                                             |
| ?        | 1234.1234   | 1234.1234              | ?????.????                                  |
|          | -123.123    | - 123.123              | ?????.????                                  |
|          | 12.123      | 12.123                 | ?????.????                                  |
|          | 0           | .                      | ?????.????                                  |
|          |             |                        |                                             |
| %        | 56          | 5600.00%               | 0.00%                                       |
|          | 5.6         | 560.00%                | 0.00%                                       |
|          | 0.567       | 56.70%                 | 0.00%                                       |
|          |             |                        |                                             |
| 千分隔符 | 123456      | 123,456                | #,##0                                       |
|          | 123456789   | 123,456,789            | #,##0                                       |
|          |             |                        |                                             |
| 插入文字 | 5463        | MU 5463                | "MU" 0000                                   |
|          | 1234567890  | USD 1,235M             | "USD "#,##0,,"M"                            |
|          | 1234567890  | 人民币1,235百万        | "人民币"#,##0,,"百万"                       |
|          |             |                        |                                             |
| 文字格式 | 财务        | 集团公司财务部         | ;;;"集团公司"@"部"                          |
|          | 采购        | 集团公司采购部         | ;;;"集团公司"@"部"                          |
|          |             |                        |                                             |
| 颜色     | 123456      | 123,456                | #,##0;[红色]-#,##0                          |
|          | -123456     | -123,456               | #,##0;[红色]-#,##0                          |
|          | 123         | 123                    | [蓝色]0                                     |
|          |             |                        |                                             |
| 颜色 n   | 123456      | 123,456                | [颜色1]#,##0                                |
|          | 123456      | 123,456                | [颜色9]#,##0                                |
|          | 123456      | 123,456                | [颜色23]#,##0                               |
|          |             |                        |                                             |
| 左排齐   | 1234        | RMB1,234               | _("RMB"* #,##0_);("RMB"* #,##0)             |
|          | -123456     | (RMB123,456)           | _("RMB"* #,##0_);("RMB"* #,##0)             |
|          | 0           | RMB0                   | _("RMB"* #,##0_);("RMB"* #,##0)             |
|          |             |                        |                                             |
| 条件     | 28758965    | 2875 8965              | `[>99999999](0###) #### ####;#### ####`     |
|          | 2123459821  | (021) 2345 9821        | `[>99999999](0###) #### ####;#### ####`     |
|          | 75523459821 | (0755) 2345 9821       |                                             |
|          | 99          | 99                     | `[>100][红色]0;[蓝色]0`                     |
|          | 105         | 105                    | `[>100][红色]0;[蓝色]0`                     |
|          | 123.7       | 123.70                 | `[绿色][>100]#,##0.00;[<100][红色]#,##0.00` |
|          | 87          | 87.00                  | `[绿色][>100]#,##0.00;[<100][红色]#,##0.00` |
|          |             |                        |                                             |
| 中文数字 | 123456      | 一十二万三千四百五十六 | [DBNum1]G/通用                              |
|          | 123456      | 壹拾贰万叁仟肆佰伍拾陆 | [DBNum2]G/通用                              |
|          | 123456      | 一二三四五六           | [DBNum1]0                                   |
|          | 123456      | 壹贰叁肆伍陆           | [DBNum2]0                                   |



### Excel 基本操作

本章介绍内容：

（1）数据录入

（2）单元格操作

（3）查找替换筛选

（4）复制粘贴

（5）表格转表



#### 表格数据与表数据的差别

| 表格数据：                         | 表数据：                             |
| ---------------------------------- | ------------------------------------ |
| 1.以单元格为基本数据储存及操作单位 | 以列（字段）为基本数据储存及操作单位 |
| 2.处理批量数据效率低               | 易于批量处理大量数据                 |
| 3.无法与外部数据关联               | 可以关联外部数据                     |

我们主要是用表数据进行数据的加工和处理。

表其实是一个数据库的概念，数据库的表和Excel的表结构是差不多的意思。我们无法只对某个单元格的数据进行处理，只能通过整行或整列进行处理。

#### 数据录入

##### 1.1表格和数据的标准化和规范化

管理表格 - 基础数据存储和管理:

a. 首行列标题

b. 数据格式统一

在基础数据表中应该避免：

a. 空行

b. 合并单元格

c. 不必要的公式

##### 1.2数据录入

| a.   | 选择单元格，直接录入 |
| ---- | -------------------- |
| b.   | 公式输入栏           |
| c.   | F2进入编辑模式       |
| d.   | ESC取消正在输入的值  |

##### 1.3输入操作

| 录入数据后按下 | 行为                       |
| -------------- | -------------------------- |
| Enter键        | 确认并进入下方单元格       |
| Tab键          | 确认并进入右方单元格       |
| 方向键         | 确认并进入方向键对应单元格 |
| Ctrl+D         | 复制单元格上方数据         |

#### 单元格操作

##### 2.1 插入、选择操作

a.右键，选择要插入的位置，行上方，列左边插入

b.多行多列:

- 鼠标连续选择行号或列号，然后右键插入
- Shift连续的多行多列，然后插入
- Ctrl不连续的多行多列，然后右键插入

c.单元格方法同行和列

##### 2.2 行列转置

将

| 姓名 | 性别 |
| ---- | ---- |
| a    | 男   |
| b    | 女   |
| c    | 男   |

变为：

| 姓名 | 杨宝春 | 许东东 | 杨小肖 |
| ---- | ------ | ------ | ------ |
| 性别 | 男     | 女     | 男     |

怎样做？

选中所有表格数据——复制——粘贴，选择性粘贴——转置

##### 2.3 在空单元格内快速填充相同的内容

| 姓名 | 年龄 | 身高 |
| ---- | ---- | ---- |
| a    |      | 178  |
| b    | 25   |      |
| c    |      | 165  |
| d    |      |      |

变为：

| 姓名 | 年龄 | 身高 |
| ---- | ---- | ---- |
| a    | 填充 | 178  |
| b    | 25   | 填充 |
| c    | 填充 | 165  |
| d    | 填充 | 填充 |

怎样做？

1.选中单元格区域

2.开始-编辑-查找和选择-定位条件，选中-空值，确认。

*在WPS中可以用ctrl+G，不知道微软office Excel中是否可行。

![image-20191124145159764](数据分析师(Excel+SQL).assets/image-20191124145159764.png)

3.在顶端fx后面或直接输入要填充的数据，点按ctrl+回车

![image-20191124145556088](数据分析师(Excel+SQL).assets/image-20191124145556088.png)

##### 2.4 隔行插入空白行

将

| 姓名 | 级别 | 收入  |
| ---- | ---- | ----- |
| a    | S2   | 20000 |
| b    | S3   | 18000 |
| c    | S2   | 35000 |
| d    | S4   | 50000 |
| e    | S6   | 70000 |

变成这样（每一行下面都插入一个空白行）：

| 姓名 | 级别 | 收入  |
| ---- | ---- | ----- |
|      |      |       |
| a    | S2   | 20000 |
|      |      |       |
| b    | S3   | 18000 |
|      |      |       |
| c    | S2   | 35000 |
|      |      |       |
| d    | S4   | 50000 |
|      |      |       |
| e    | S6   | 70000 |

怎样做？

这个时候需要添加辅助列，然后将有数值的列为单数，然后再在下面空白的地方填充双数，接着可以排序就可以了：

![image-20191124150310342](数据分析师(Excel+SQL).assets/image-20191124150310342.png)



#### 3.查找替换和筛选

##### 3.1 查找替换

Ctrl+F查找和替换

使用通配符 * 代替任意多个字符

使用通配符 ? 代表一个字符

练习：将下面带有北的单元格变为练习二字

| 姓名 | 性别 | 民族 | 籍贯       |
| ---- | ---- | ---- | ---------- |
| a    | 男   | 回   | 湖北黄石   |
| b    | 男   | 汉   | 河北南宫   |
| c    | 男   | 汉   | 江苏沛县   |
| d    | 男   | 汉   | 湖北神农架 |
| e    | 男   | 藏   | 湖北武汉   |

![image-20191124151046505](数据分析师(Excel+SQL).assets/image-20191124151046505.png)

![image-20191124151104551](数据分析师(Excel+SQL).assets/image-20191124151104551.png)

没有符合对象的话是不会替换的。



##### 3.2 排序与筛选

这个功能主要为：

a.升序与降序——区域选择中的单元格移动

b.自定义排序——添加自定义序列

c.筛选

练习：

1. 按照出生年月及年龄顺序对表格进行升序排序

2. 筛选大专以上男性

| 姓名 | 性别 | 出生年月 | 年龄 | 文化程度 |
| ---- | ---- | -------- | ---- | -------- |
| a    | 男   | 1974     | 40   | 研究生   |
| b    | 男   | 1955     | 59   | 研究生   |
| c    | 男   | 1956     | 58   | 研究生   |
| d    | 女   | 1973     | 40   | 研究生   |
| e    | 男   | 1952     | 61   | 研究生   |
| f    | 女   | 1961     | 52   | 大专     |
| g    | 男   | 1980     | 34   | 大专     |
| h    | 女   | 1960     | 53   | 大学本科 |
| i    | 男   | 1971     | 43   | 大学本科 |
| j    | 男   | 1953     | 60   | 大学本科 |

![image-20191124152013909](数据分析师(Excel+SQL).assets/image-20191124152013909.png)



#### 复制粘贴

| 4.1  | 复制粘贴      |      |
| ---- | ------------- | ---- |
| a.   | Ctrl+c 复制   |      |
| b.   | Ctrl+v 全粘贴 |      |
| c.   | 选择粘贴      |      |

最主要的是选择粘贴：

- 只粘贴数值
- 粘贴格式
- 粘贴验证——这个是限定输入
- 粘贴运算
- 粘贴图片链接——图片的内容根据表格的变动而变动

#### 表格转表



表格转表是什么意思呢？

一开始的时候就说了，表格数据和表数据不一样，表格的操作是可以操作某个单元格，而表的操作是按字段，一列一列的。比方说，在将表格转为表后，选择年龄字段中的某个数据+1，最终的结果会是整个字段+1，这就印证了，表的操作只能按字段，批量地操作。

数据：

| 姓名 | 性别 | 出生年月 | 年龄 | 文化程度 |
| ---- | ---- | -------- | ---- | -------- |
| a    | 男   | 1974     | 40   | 研究生   |
| b    | 男   | 1955     | 59   | 研究生   |
| c    | 男   | 1956     | 58   | 研究生   |
| d    | 女   | 1973     | 40   | 研究生   |
| e    | 男   | 1952     | 61   | 研究生   |

操作：

![image-20191124152914457](数据分析师(Excel+SQL).assets/image-20191124152914457.png)

![image-20191124153234000](数据分析师(Excel+SQL).assets/image-20191124153234000.png)

![image-20191124153347930](数据分析师(Excel+SQL).assets/image-20191124153347930.png)





### Excel公式功能

函数公式：用来对单个单元格或指定单元格区域进行计算后返回计算结果，公式返回的计算结果可以是数值、数组、单元格地址等、

函数由等号、函数表达式、操作符、参数、返回值五个部分组成。比方说：

![image-20191124154334767](数据分析师(Excel+SQL).assets/image-20191124154334767.png)

 这是一个sum函数，15是这个函数的返回值。

其他一些基本函数就不作详细记录，主要看看下面这些函数：

##### OFFSET函数

![image-20191124154656601](数据分析师(Excel+SQL).assets/image-20191124154656601.png)

以指定的引用为参照系，通过给定偏移量返回新的引用区域。

**语法：OFFSET(reference,rows,cols,height,width)**

reference：参考基准单元格位置

rows：行位移，以基准单元格为起点，向下（正数）或向上（负数）的移动量

cols：列位移，以基准单元格为起点，向右（正数）或向左（负数）的移动量

height：行高，以移动过后的位置基准点，向下连续取得行数

width：列宽，以移动过后的位置基准点，向右连续取得列数



offset不能用在单元格里，那么我们学这个有什么意义呢？我们是用在名称定义里，然后再将名称定义里的名称指定到图表中，作为图表的数据源使用。通过这些操作进行图表的动态交互展现效果。具体的制作方法在后面会用到

##### 嵌套函数

将内部函数的返回值作为外部函数的藏书使用的方法，使用嵌套函数时，内部函数的返回值数据类型一定要与外部函数的参数数据类型一致。

基本数据类型：文本型、数值型、布尔型、数组

| 公式     | IF(ISERROR(I2),"Error","OK") | 参考单元格 |
| -------- | ---------------------------- | ---------- |
| 公式结果 | Error                        | #DIV/0!    |

公式解释：

| 1.ISERROR函数判断I2单元格值是否为Error值                     |
| ------------------------------------------------------------ |
| 2.因为I2是Error值所以ISERROR函数返回布尔值TRUE               |
| 3.因为IF函数的第一个参数是ISERROR函数返回的TRUE。所以IF函数执行第一个参数为TRUE时的操作返回第二个参数ERROR |

### Excel条件格式

Excel中的条件格式种类繁多，不可能一一讲解，下面我们就用三个案例，讲解三种不同类型的条件格式，希望大家可以举一反三。

#### 以单元格的值为基础，设定条件格式

这种类型不需要用公式设定，只需要满足某个条件就可以

例：单元格值介于15和25之间的单元格标为黄色

![image-20191124162158773](数据分析师(Excel+SQL).assets/image-20191124162158773.png)

![image-20191124171914113](数据分析师(Excel+SQL).assets/image-20191124171914113.png)



#### 以公式返回值为基础设定条件格式

这种需要用公式

例1：第二列值大于第一列值时将第一列中单元格标为黄色

=$B$9>$A$9 ——这里的$为锁定单元格的意思，我们要去掉

![image-20191124171937867](数据分析师(Excel+SQL).assets/image-20191124171937867.png)



例2：将位于偶数行的单元格标为黄色

使用的公式为：=MOD(ROW(),2)=0

![image-20191124162846151](数据分析师(Excel+SQL).assets/image-20191124162846151.png)

![image-20191124172010231](数据分析师(Excel+SQL).assets/image-20191124172010231.png)

#### 图标集

图标集：用图标的不同状态来标注当前单元格值与阈（yu）值间的对比关系

1：Excel中又三种状态、四种状态和物种状态，三种类型的图标集

2：阈值类型有数字、百分比、公式以及百分点值四种类型

@红黄绿三色红绿灯图标使用最为频繁，如遇选择困难，可以使用红绿灯图标

| 图标集：用红绿灯图标集标注销售金额字段单元格 |          |                     |
| -------------------------------------------- | -------- | ------------------- |
| 平均值                                       | 100      |                     |
|                                              | 销售金额 | 图标集装填说明      |
| 产品1                                        | 100      | 大于或等于平均值    |
| 产品2                                        | 200      | 大于或等于2倍平均值 |
| 产品3                                        | 50       | 小于平均值          |
| 产品4                                        | 80       | 小于平均值          |
| 产品5                                        | 70       | 小于平均值          |

![image-20191124163925103](数据分析师(Excel+SQL).assets/image-20191124163925103.png)

![image-20191124170437594](数据分析师(Excel+SQL).assets/image-20191124170437594.png)

#### 数据条和色阶

**数据条：用数据条的长短来标注各单元格值得大小关系**

数据条以一组单元格中的最大值为最长条形，用数据条的长短变化来标注其他单元格与此单元格值得对比关系



**色阶：用不同颜色变化来标注各单元格值得大小关系**

色阶以一组单元格中的最大值为最重颜色，用颜色变化来标注其他单元格与此单元格值得对比关系

*如果要利用数据条或色阶来体现各部分值与汇总值之间的占比关系，选定单元格区域内应包含汇总值*

操作：

1.数据条：用数据条的长短来标注销售数量字段单元格的大小关系

2.色阶：用色阶来标注销售金额字段各单元格的大小关系

![image-20191124170600941](数据分析师(Excel+SQL).assets/image-20191124170600941.png)



#### 迷你图

迷你图是放入单个单元格中的小型图，代表所选内容中的一行数据

*迷你图可以使用在表格中与单元格值结合使用，令报表阅读者可以通过图表直观掌握到表格数据的对比趋势，加深阅读者对抽象数据的理解及印象。*

![image-20191124170950948](数据分析师(Excel+SQL).assets/image-20191124170950948.png)

在WPS中好像没有迷你图？？



### Excel数据透视表功能

#### 数据透视表：

由“筛选器”、“行，列标签”、"值"构成的二维值汇总表

1. 易操作性：“拖”字大法，只需要通过鼠标对字段直接进行拖拽就能完成多数操作
2. 可计算性：多种计算方法，包括求和，计数，求平均值，百分比等汇总计算规则
3. 数据处理方法多：排序、筛选、分类汇总等多种数据加工处理方法

*数据透视表就用来将一维数据转换为由行列构成的二维数据值汇总表

![image-20191124173934621](数据分析师(Excel+SQL).assets/image-20191124173934621.png)

#### 数据透视图：

基于数据透视表生产的图标，数据透视图由“筛选器”，“图例”，“轴”以及“值”构成，用户可以通过鼠标拖拽来快速更改图标的显示结果。数据透视图中没有Excel基本图标类型中的“散点图”和“气泡图”。

*数据图示图既可以通过数据透视表生成，也可以直接引用一般的表格数据生成。通过一般表格数据生成数据透视图时会自动生成与其对应的数据透视表。

![image-20191124174520552](数据分析师(Excel+SQL).assets/image-20191124174520552.png)



#### 切片器：

在Excel 2010以上的版本中，微软增加了切片器工具。当切片器与数据透视表关联后，切片器进行选择时，数据透视表会一起发生变化。

*切片器与数据透视表的组合应用是生产BI报表高度交互性可视化界面的基础

![image-20191124181435886](数据分析师(Excel+SQL).assets/image-20191124181435886.png)

我们要明白其中的逻辑关系，才能做好数据透视表

**数据透视表和数据透视图操作：**

- Ctrl+shift+Enter可以将选择区域拉到最底

- 选择数据后点击数据透视表，然后选择一个位置放透视表
- 当数据透视表符合自己的需求后，点击创建数据透视图

- 可以取消筛选框，分析-字段按钮-取消

- 排列数据透视表和图

  随便选一个发生额的值，右键，升序排序



**切片器操作：**

- 选择数据透视表的单元格——插入——切片器，然后可以选择

  ![image-20191124184218159](数据分析师(Excel+SQL).assets/image-20191124184218159.png)

- 用切片器，控制没有关联的数据表可以吗？可以的，通过右键——报表链接——点击选择关联的报表

- 条件限定：数据源应该是同一个数据源，假如来自不同的数据源，切片器时无办法将他们连在一起的

- 切片器可以是多选的，只需要按照CTRL+点击就可以，双击的话是选择全部选项



### Excel基本图表功能



| 图表类型           | 展示方式   | 变量个数 | 特点                 | 样例                                                         |
| ------------------ | ---------- | -------- | -------------------- | ------------------------------------------------------------ |
| 柱形图（基于分类） | 比较       | 1        | 多个分类项目比较     | ![img](数据分析师(Excel+SQL).assets/clip_image5-1574593540642.png) |
| 柱形图（基于时间） | 比较       | 1        | 不同时点的数值比较   | ![img](数据分析师(Excel+SQL).assets/clip_image6-1574593548310.png) |
| 条形图             | 比较       | 1        | 多个分类项目比较     | ![img](数据分析师(Excel+SQL).assets/clip_image8-1574593555657.png) |
| 折线图             | 比较       | 1        | 不同时点的数值比较   | ![img](数据分析师(Excel+SQL).assets/clip_image10-1574593562698.png) |
| 饼图               | 构成       | 1        | 整体中各部分的占比   | ![img](数据分析师(Excel+SQL).assets/clip_image14-1574593574490.png) |
| 散点图             | 分布、联系 | 2        | 数据间的分布及关联性 | ![img](数据分析师(Excel+SQL).assets/clip_image12-1574593578789.png) |
| 气泡图             | 联系       | 3        | 数据间的联系比较     | ![img](数据分析师(Excel+SQL).assets/clip_image16-1574593587321.png) |
| 雷达图             | 比较       | 多个     | 多重数据间的比较     | ![img](数据分析师(Excel+SQL).assets/clip_image17-1574593531881.png) |

最重要的是按照实际情况去选择相应的图表。

一个图表是由多个对象组成的：看添加图表元素那里

##### 柱形图（基于分类）

它的作用是比较，变量个数是一个，是根据**多个分类项目**进行比较。是多个产品或分类在同一个纬度的比较。

| 产品  | 三季度销售额 |
| ----- | ------------ |
| 产品a | 10000000     |
| 产品b | 15000000     |
| 产品c | 13000000     |
| 产品d | 14000000     |

![image-20191124200712878](数据分析师(Excel+SQL).assets/image-20191124200712878.png)

这个数据中，变量只有一个，而且名称是没有时间顺序的，用于不同产品中的比较，所以我们可以用柱形图来做数据可视化。（当然也可以选择条形图和饼图这些单个变量的图）

坐标标签，设置坐标系格式，显示单位，还有很多地方可以改的。



##### 柱形图（基于时间）

它的作用是比较，变量个数是一个，是基于**不同时点的数值**进行比较。同一个产品在不同时间段的比较

| 产品a  | 销售额   |
| ------ | -------- |
| Apr-15 | 10000000 |
| May-15 | 15000000 |
| Jun-15 | 13000000 |
| Jul-15 | 14000000 |

![image-20191124202331881](数据分析师(Excel+SQL).assets/image-20191124202331881.png)





##### 条形图

一般用于比较，多个分类项目间的比较，和基于分类的柱形图差不多。

| 产品  | 三季度销售额 |
| ----- | ------------ |
| 产品a | 10000000     |
| 产品b | 15000000     |
| 产品c | 13000000     |
| 产品d | 14000000     |

![image-20191124201359219](数据分析师(Excel+SQL).assets/image-20191124201359219.png)



##### 折线图（基于较多的时间）

不同时点的数值比较，一般用于连续或时间比较多的时点进行比较。

例子：



![image-20191124202559671](数据分析师(Excel+SQL).assets/image-20191124202559671.png)

##### 饼图

在构成占比分析中会经常使用

| 产品  | 三季度销售额 |
| ----- | ------------ |
| 产品a | 10000000     |
| 产品b | 15000000     |
| 产品c | 13000000     |
| 产品d | 14000000     |

![image-20191124202216077](数据分析师(Excel+SQL).assets/image-20191124202216077.png)

里面可以设置标签，引导线之类的格式，多练习练习就好

##### 散点图

分布和联系，可以考虑每个变量间的关联性。变量个数是2，做完散点图后还可能根据需求画趋势线，有指数，有线性，是根据回归系数画出来的

| 产品  | 销售额   | 价格     |
| ----- | -------- | -------- |
| 产品a | 10000000 | 534894.9 |
| 产品b | 15000000 | 407990.8 |
| 产品c | 13000000 | 3249352  |
| 产品d | 14000000 | 5680572  |

选择数据范围的时候**只需要选有数值**的部分，然后再添加各个标签，接着加趋势线

![image-20191124204114420](数据分析师(Excel+SQL).assets/image-20191124204114420.png)



##### 气泡图

主要用来展示联系，有三个变量，在散点图的基础上加上了值得大小，特点是数据间的联系和比较

| 产品  | 增长率 | 退货率 | 销售额   |
| ----- | ------ | ------ | -------- |
| 产品a | 25%    | 1%     | 10000000 |
| 产品b | 50%    | 4%     | 15000000 |
| 产品c | 75%    | 3%     | 13000000 |
| 产品d | 100%   | 2%     | 14000000 |

- 数据的区间？**只要有数值的部分**
- 选中点，单个改相应的颜色和参数
- 添加标签，来自单元格中的值，选择产品，设置显示的
- ![image-20191124204729517](数据分析师(Excel+SQL).assets/image-20191124204729517.png)



代表什么意思？

![image-20191124205254959](数据分析师(Excel+SQL).assets/image-20191124205254959.png)

产品A增长率是25%，退货率是1%，销售额是1000000，这个时候我们就可以在气泡图中看出来，横坐标是增长率，竖坐标是退货率，图形的大小是总销售额，和其他比较起来，虽然他的退货率低，但它的增长率和销售额也低，它的销售额低，说明他的销量可能有问题，也有可能本来的单价就低

##### 雷达图

用来做比较，没有具体变量限制，用于多重数据间的比较

我们可以看到这个雷达图，这三个维度是评级的，看看这三个评级的数值分布情况，然后用各个产品间比较，我们用什么作为维度？

| 产品  | 市场 | 售后 | 价格 |
| ----- | ---- | ---- | ---- |
| 产品a | 5000 | 2000 | 7000 |
| 产品b | 3126 | 1740 | 4543 |
| 产品c | 149  | 1258 | 5165 |
| 产品d | 2556 | 1191 | 4473 |



![image-20191124205722227](数据分析师(Excel+SQL).assets/image-20191124205722227.png)

注意：这个需要选择标签名，也就是说全部数据都选择

